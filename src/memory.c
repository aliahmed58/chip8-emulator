#include "../include/memory.h"
#include <stdio.h>
#include <string.h>

short memory[256];

// method initalizes memory with font and needed initial stuff
void init_memory() {
  // set complete memory to 0s
  // the only usable memory starts after address 0x200 according to old
  // conventions
  int memory_size = sizeof(memory);
  memset(memory, 0, memory_size);

  // set font in memory
  short font_hex[80] = {
      0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
      0x20, 0x60, 0x20, 0x20, 0x70, // 1
      0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
      0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
      0x90, 0x90, 0xF0, 0x10, 0x10, // 4
      0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
      0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
      0xF0, 0x10, 0x20, 0x40, 0x40, // 7
      0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
      0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
      0xF0, 0x90, 0xF0, 0x90, 0x90, // A
      0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
      0xF0, 0x80, 0x80, 0x80, 0xF0, // C
      0xE0, 0x90, 0x90, 0x90, 0xE0, // D
      0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
      0xF0, 0x80, 0xF0, 0x80, 0x80  // F
  };
  int font_array_size = sizeof(font_hex);
  nbytes_tm(0x50, 0x9F, font_array_size, font_hex);

  for (int i = 0x50; i < 0x9F; i++) {
    printf("%x ", memory[i]);
    if (i % 5 == 0) {
      printf("\n");
    }
  }
}

int nbytes_tm(int start_index, int end_index, int b_size, short *bytes) {

  int b_counter = 0;
  for (int i = start_index; i < end_index; i++) {
    memory[i] = bytes[b_counter];
    if (b_counter >= b_size) {
      break;
    }
    b_counter++;
  }
  return 0;
}
